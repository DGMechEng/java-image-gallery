
package edu.au.cc.gallery;
import software.amazon.awssdk.regions.Region;
import software.amazon.awssdk.services.s3.S3Client;
import software.amazon.awssdk.services.s3.model.CreateBucketConfiguration;
import software.amazon.awssdk.services.s3.model.CreateBucketRequest;

public class S3 {
    private static final region = Region.US_WEST_2;
    private S3Client client;

    public void connect() {
	client = S3Client.builder().region(region).build();
    }

    public void createBucket(String bucketName){
	CreateBucketRequest createBucketRequest = CreateBucketRequest
	    .builder()
	    .bucket(bucketName)
	    .CreateBucketConfiguration(CreateBucketConfiguration.builder()
				       .locationConstraint(region, id())
				       .build())
	    .build();
	client.createBucketRequest(createBucketRequest);
    }
    
    public static void demo() {
	//new S3().connect();
	S3 s3 = new S3();
	s3.connect();
	s3.createBucket("edu.au.cc.image-gallery");
    }
}
